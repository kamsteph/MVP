import 'dart:convert'; // Required for Map<String, dynamic> if you use jsonDecode/jsonEncode internally for 'data'

class VulnerabilityEntry {
  final String alert;
  final String risk;
  final String confidence;
  final String url;
  final String method;
  final String? param;
  final String? attack;
  final String? evidence;
  final String description;
  final String solution;
  final String? cweid;
  final String? wascid;
  final String? sourceid;
  final Map<String, dynamic>? data; // For any extra data not explicitly mapped

  VulnerabilityEntry({
    required this.alert,
    required this.risk,
    required this.confidence,
    required this.url,
    required this.method,
    this.param,
    this.attack,
    this.evidence,
    required this.description,
    required this.solution,
    this.cweid,
    this.wascid,
    this.sourceid,
    this.data,
  });

  // Factory constructor to create a VulnerabilityEntry from a JSON Map
  factory VulnerabilityEntry.fromJson(Map<String, dynamic> json) {
    return VulnerabilityEntry(
      alert: json['alert'] ?? 'N/A', // Provide default if null or missing
      risk: json['risk'] ?? 'Informational',
      confidence: json['confidence'] ?? 'High',
      url: json['url'] ?? 'N/A',
      method: json['method'] ?? 'N/A',
      param: json['param'],
      attack: json['attack'],
      evidence: json['evidence'],
      description: json['description'] ?? 'No description provided.',
      solution: json['solution'] ?? 'No solution provided.',
      cweid: json['cweid'],
      wascid: json['wascid'],
      sourceid: json['sourceid'],
      // Ensure 'data' is parsed as a Map<String, dynamic>
      data: json['data'] is Map ? Map<String, dynamic>.from(json['data']) : null,
    );
  }

  // Method to convert a VulnerabilityEntry object to a JSON-serializable Map
  Map<String, dynamic> toJson() {
    return {
      'alert': alert,
      'risk': risk,
      'confidence': confidence,
      'url': url,
      'method': method,
      'param': param,
      'attack': attack,
      'evidence': evidence,
      'description': description,
      'solution': solution,
      'cweid': cweid,
      'wascid': wascid,
      'sourceid': sourceid,
      'data': data, // This will be null or a Map, which jsonEncode handles
    };
  }
}