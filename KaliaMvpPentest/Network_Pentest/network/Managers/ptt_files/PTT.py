# file: Network_Pentest/network/Managers/network_ptt.py

INPT_PTT_TEMPLATE = {
    "test_type": "INPT",                    # internal network penetration test
    "current_phase": "P1",                  # P1, P2, P3, P4
    "current_step": "P1A_HOST_DISCOVERY",   # one of the step ids below
    "completed_steps": [],                  # list of step ids
    "history": []                           # list of {ts, phase, step, action, note}
}

INPT_PTT_STEPS = {
    "P1": {
        "name": "Information gathering",
        "steps": {
            "P1A_HOST_DISCOVERY": {
                "label": "Discover network hosts",
                "module": "recon",      # who should act first
                "description": "Identify live hosts on internal network ranges."
            },
            "P1B_ENUM_SERVICES": {
                "label": "Enumerate listening services",
                "module": "recon",
                "description": "Enumerate open ports and services on discovered hosts."
            },
            "P1C_DISCOVER_SURFACES": {
                "label": "Discover vulnerable attack surfaces",
                "module": "vai",
                "description": "Use vulnerability analysis to identify likely attack surfaces."
            }
        }
    },
    "P2": {
        "name": "Focused penetration or pre-exploitation",
        "steps": {
            "P2A_COMPROMISE_LEVEL1": {
                "label": "Compromise vulnerable hosts (level 1)",
                "module": "exp",
                "description": "Exploit weakest, high-value targets first."
            },
            "P2B_EXPLOIT_MISSING_PATCHES": {
                "label": "Exploit missing software patches",
                "module": "exp",
                "description": "Exploit known missing patches on level 1 hosts."
            },
            "P2C_RMI_ACCESS": {
                "label": "Access remote management interfaces (RMI)",
                "module": "exp",
                "description": "Abuse exposed RMI / admin interfaces."
            }
        }
    },
    "P3": {
        "name": "Post-exploitation & privilege escalation",
        "steps": {
            "P3A_ESTABLISH_REENTRY": {
                "label": "Establish reliable re-entry",
                "module": "exp",
                "description": "Create safe, documented re-entry mechanisms (no uncontrolled persistence)."
            },
            "P3B_HARVEST_CREDS": {
                "label": "Harvest credentials",
                "module": "exp",
                "description": "Safely harvest credentials for lateral movement; log all actions."
            },
            "P3C_MOVE_LATERAL_LEVEL2": {
                "label": "Move laterally (level 2)",
                "module": "exp",
                "description": "Use harvested access to compromise next-tier hosts."
            },
            "P3D_IDENT_PRIV_USERS": {
                "label": "Identify privileged user accounts",
                "module": "vai",
                "description": "Identify high-privilege users for targeted escalation."
            },
            "P3E_ELEVATE_DOMAIN_ADMIN": {
                "label": "Elevate to domain admin",
                "module": "exp",
                "description": "Attempt domain admin / tier-0 only if in scope and allowed."
            }
        }
    },
    "P4": {
        "name": "Documentation",
        "steps": {
            "P4A_GATHER_EVIDENCE": {
                "label": "Gather evidence/screenshots",
                "module": "docs",
                "description": "Collect proof-of-finding screenshots and logs."
            },
            "P4B_LINEAR_NARRATIVES": {
                "label": "Create linear attack narratives",
                "module": "docs",
                "description": "Build clear attack chains from initial foothold to impact."
            },
            "P4C_FINAL_DELIVERABLE": {
                "label": "Create final deliverable",
                "module": "docs",
                "description": "Generate final report and executive summary."
            }
        }
    }
}
