# file: Network_Pentest/network/Managers/network_llm_schema.py

LLM_PLAN_SCHEMA = {
    "type": "object",
    "required": ["ptt_state_out", "recommended_actions", "confidence"],
    "properties": {
        "ptt_state_out": {
            "type": "object",
            "required": ["current_phase", "current_step", "completed_steps"],
            "properties": {
                "current_phase": {"type": "string"},              # e.g. "P1"
                "current_step": {"type": "string"},               # e.g. "P1B_ENUM_SERVICES"
                "completed_steps": {
                    "type": "array",
                    "items": {"type": "string"}
                }
            },
            "additionalProperties": False
        },
        "recommended_actions": {
            "type": "array",
            "items": {
                "type": "object",
                "required": ["module", "action_type", "targets"],
                "properties": {
                    "module": {
                        "type": "string",
                        "enum": ["recon", "vai", "exp", "docs"]
                    },
                    "action_type": {
                        "type": "string",
                        "enum": [
                            "RUN_RECON_PHASE1",
                            "RUN_VAI_ANALYSIS",
                            "RUN_EXPLOIT_SIMULATION",
                            "RUN_EXPLOIT_PRODUCTION",
                            "RUN_DOC_SUMMARY"
                        ]
                    },
                    "targets": {
                        "type": "array",
                        "items": {"type": "string"}
                    },
                    "notes": {"type": "string"}
                },
                "additionalProperties": False
            }
        },
        "cross_domain_alerts": {
            "type": "array",
            "items": {
                "type": "object",
                "required": ["kind", "details"],
                "properties": {
                    "kind": {
                        "type": "string",
                        "enum": [
                            "AD_POSSIBLE",
                            "WEB_POSSIBLE",
                            "CLOUD_POSSIBLE",
                            "OTHER"
                        ]
                    },
                    "details": {"type": "string"}
                },
                "additionalProperties": False
            },
            "default": []
        },
        "confidence": {
            "type": "number",
            "minimum": 0.0,
            "maximum": 1.0
        }
    },
    "additionalProperties": False
}
