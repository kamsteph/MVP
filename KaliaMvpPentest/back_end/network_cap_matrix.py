# NETWORK_CAPABILITY_MATRIX
NETWORK_CAPABILITY_MATRIX = [
    {
        "attack_surface": "Open ports",
        "description": "Scan for open TCP/UDP ports",
        "packet_type": "tcp",
        "default_ports": "top10",
        "tools": [
            {
                "name": "Masscan",
                "role": "enumeration",
                "priority": 1,
                "default_ports": "top100",
                "supports_custom_ports": True,
                "supports_ipv6": False,
                "ipv6_notes": "Masscan historically has limited/unstable IPv6 support on many builds. Prefer Naabu/Nmap for IPv6 unless you have a recent IPV6-capable Masscan binary."
            },
            {
                "name": "Naabu",
                "role": "enumeration",
                "priority": 2,
                "default_ports": "top100",
                "supports_custom_ports": True,
                "supports_ipv6": True,
                "ipv6_notes": "Naabu supports IPv6 (use -6 flag on versions that require it). Accepts single IPv6 and small CIDRs in modern versions."
            },
            {
                "name": "Nmap",
                "role": "service_detection",
                "priority": 3,
                "default_ports": "top10",
                "supports_custom_ports": True,
                "supports_ipv6": True,
                "ipv6_notes": "Full IPv6 support. Use -6 flag for IPv6 runs; supports IPv6 CIDRs and single IPv6 addresses."
            }
        ],
    },

    {
        "attack_surface": "Network services (SMB, FTP, DNS, SNMP)",
        "description": "Check if network services are reachable and identify versions",
        "packet_type": "tcp",
        "default_ports": "top10",
        "tools": [
            {
                "name": "Nmap",
                "role": "service_detection",
                "priority": 1,
                "default_ports": "top10",
                "supports_custom_ports": True,
                "supports_ipv6": True,
                "ipv6_notes": "Nmap supports service version detection over IPv6."
            },
            {
                "name": "Nmap-scripts",
                "role": "service_fingerprinting",
                "priority": 2,
                "default_ports": "top10",
                "supports_custom_ports": True,
                "supports_ipv6": True,
                "ipv6_notes": "NSE scripts work over IPv6 where supported by the target service."
            }
        ]
    },

    {
        "attack_surface": "Firewalls, IDS/IPS",
        "description": "Advanced firewall/IDS fingerprinting and deep inspection",
        "packet_type": "both",
        "default_ports": "all",
        "tools": [
            {
                "name": "CustomVulnScanner",
                "role": "deep_inspect",
                "priority": 1,
                "default_ports": "all",
                "supports_custom_ports": False,
                "supports_ipv6": True,
                "ipv6_notes": "Custom scanner — assume IPv6 support can be implemented. Verify and add flags if necessary."
            },
            {
                "name": "Nmap",
                "role": "service_detection",
                "priority": 5,
                "default_ports": "top10",
                "supports_custom_ports": True,
                "supports_ipv6": True,
                "ipv6_notes": "Useful for fingerprinting firewall behavior over IPv6 as well."
            }
        ]
    },

    {
        "attack_surface": "Routers/switches",
        "description": "Identify routers/switches and management interfaces",
        "packet_type": "tcp",
        "default_ports": "top10",
        "tools": [
            {
                "name": "Nmap",
                "role": "service_detection",
                "priority": 1,
                "default_ports": "top10",
                "supports_custom_ports": True,
                "supports_ipv6": True,
                "ipv6_notes": "Nmap works for IPv6-enabled management interfaces (SNMPv6, web UI over IPv6)."
            }
        ]
    },

    {
        "attack_surface": "Wireless networks",
        "description": "Discover and enumerate nearby wireless networks",
        "packet_type": "n/a",
        "default_ports": "n/a",
        "tools": [
            {
                "name": "Kismet",
                "role": "wireless_discovery",
                "priority": 1,
                "default_ports": "n/a",
                "supports_custom_ports": False,
                "supports_ipv6": False,
                "ipv6_notes": "Wireless tools operate at link layer — IPv6 flag not applicable."
            },
            {
                "name": "Aircrack",
                "role": "wireless_analysis",
                "priority": 2,
                "default_ports": "n/a",
                "supports_custom_ports": False,
                "supports_ipv6": False,
                "ipv6_notes": "Wireless analysis is link-layer — IPv6 not applicable."
            }
        ]
    },

    {
        "attack_surface": "VPN gateways",
        "description": "Test VPN gateway availability and potential misconfigurations",
        "packet_type": "tcp",
        "default_ports": "top10",
        "tools": [
            {
                "name": "Nmap",
                "role": "reachability",
                "priority": 1,
                "default_ports": "top10",
                "supports_custom_ports": True,
                "supports_ipv6": True,
                "ipv6_notes": "Nmap can test VPN ports and services over IPv6."
            },
            {
                "name": "OpenVAS",
                "role": "deep_scan",
                "priority": 2,
                "default_ports": "all",
                "supports_custom_ports": False,
                "supports_ipv6": True,
                "ipv6_notes": "Modern OpenVAS/Greenbone versions support IPv6 scanning; verify your scanner's network config."
            }
        ]
    },

    {
        "attack_surface": "Load balancers",
        "description": "Check load balancer reachability and distribution patterns",
        "packet_type": "tcp",
        "default_ports": "top10",
        "tools": [
            {
                "name": "Nmap",
                "role": "reachability",
                "priority": 1,
                "default_ports": "top10",
                "supports_custom_ports": True,
                "supports_ipv6": True,
                "ipv6_notes": "Nmap ok for IPv6-enabled backends/probes."
            },
            {
                "name": "Httprobe",
                "role": "http_probe",
                "priority": 2,
                "default_ports": "top10",
                "supports_custom_ports": False,
                "supports_ipv6": True,
                "ipv6_notes": "Httprobe (HTTP host probing) works with IPv6 hostnames or bracketed IPv6 literals."
            }
        ]
    },

    {
        "attack_surface": "Email servers",
        "description": "Check for open mail ports, weak auth, and exploits",
        "packet_type": "tcp",
        "default_ports": "all",
        "tools": [
            {
                "name": "Nmap",
                "role": "service_detection",
                "priority": 1,
                "default_ports": "top10",
                "supports_custom_ports": True,
                "supports_ipv6": True,
                "ipv6_notes": "Nmap supports scanning SMTP/IMAP/POP3 over IPv6."
            },
            {
                "name": "CustomMailScanner",
                "role": "deep_scan",
                "priority": 2,
                "default_ports": "all",
                "supports_custom_ports": False,
                "supports_ipv6": True,
                "ipv6_notes": "Custom scanner — implement IPv6 socket support if needed."
            }
        ]
    },

    {
        "attack_surface": "Web servers & proxies",
        "description": "Vulnerability scanning for web servers and proxy configurations",
        "packet_type": "tcp",
        "default_ports": "all",
        "tools": [
            {
                "name": "Nmap",
                "role": "service_detection",
                "priority": 1,
                "default_ports": "top10",
                "supports_custom_ports": True,
                "supports_ipv6": True,
                "ipv6_notes": "Nmap supports IPv6; use -6 flag when appropriate."
            },
            {
                "name": "Nikto",
                "role": "web_vuln_scanner",
                "priority": 2,
                "default_ports": "all",
                "supports_custom_ports": False,
                "supports_ipv6": True,
                "ipv6_notes": "Nikto supports IPv6 target hosts; use bracketed IPv6 literals in URLs (http://[addr]/)."
            },
            {
                "name": "CustomWebScanner",
                "role": "deep_scan",
                "priority": 3,
                "default_ports": "all",
                "supports_custom_ports": False,
                "supports_ipv6": True,
                "ipv6_notes": "Ensure HTTP client supports IPv6 and bracketed IPv6 URIs."
            }
        ]
    },

    {
        "attack_surface": "Databases",
        "description": "Identify and test database services for misconfigurations and vulnerabilities",
        "packet_type": "tcp",
        "default_ports": "all",
        "tools": [
            {
                "name": "Nmap",
                "role": "service_detection",
                "priority": 1,
                "default_ports": "top10",
                "supports_custom_ports": True,
                "supports_ipv6": True,
                "ipv6_notes": "Nmap can probe DB ports over IPv6."
            },
            {
                "name": "Sqlmap",
                "role": "deep_scan",
                "priority": 2,
                "default_ports": "all",
                "supports_custom_ports": False,
                "supports_ipv6": True,
                "ipv6_notes": "Sqlmap supports IPv6 when target URL/host is provided properly; bracket IPv6 literals in URLs."
            },
            {
                "name": "CustomDBScanner",
                "role": "deep_scan",
                "priority": 3,
                "default_ports": "all",
                "supports_custom_ports": False,
                "supports_ipv6": True,
                "ipv6_notes": "Custom scanner — implement IPv6 socket support."
            }
        ]
    }
]
